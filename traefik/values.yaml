# Traefik Helm Chart values
# https://github.com/traefik/traefik-helm-chart

image:
  tag: v3.2

# Deployment configuration
deployment:
  replicas: 1
  revisionHistoryLimit: 1

# Entry points configuration
ports:
  web:
    port: 80
    expose:
      default: true
    exposedPort: 80
    protocol: TCP
  websecure:
    port: 443
    expose:
      default: true
    exposedPort: 443
    protocol: TCP
  traefik:
    port: 8080
    expose:
      default: false

# Service configuration
service:
  type: LoadBalancer

# Resource limits
resources:
  requests:
    cpu: 100m
    memory: 64Mi
  limits:
    cpu: 300m
    memory: 128Mi

# Kubernetes providers
providers:
  kubernetesCRD:
    enabled: true
    allowCrossNamespace: true
  kubernetesIngress:
    enabled: true

# Enable ping for health checks
ping:
  entryPoint: traefik

# Disable dashboard exposure (access via port-forward if needed)
ingressRoute:
  dashboard:
    enabled: false

# Security context
securityContext:
  allowPrivilegeEscalation: false
  capabilities:
    drop:
      - ALL
    add:
      - NET_BIND_SERVICE
  readOnlyRootFilesystem: false

# Pod security context
podSecurityContext:
  runAsNonRoot: false

# Logging
logs:
  general:
    level: INFO

# Extra objects to deploy (middleware for HTTPS redirect)
extraObjects:
  - apiVersion: traefik.io/v1alpha1
    kind: Middleware
    metadata:
      name: redirect-https
      namespace: traefik
    spec:
      redirectScheme:
        scheme: https
        permanent: true
